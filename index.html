<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>Resize Photo</title>
    <meta name='description' content='Superfast, unlimited free photo resizer. No registration, no cookies.Privacy assured - we do not store your photos in our server.'/>
    <link rel="shortcut icon" type="image/x-icon" href="image/favicon.png" />
    <style>
      .hidden{display:none;}
      body{font-family:Arial,Helvetica,sans-serif;}
      h1{background-color: rgba(0,0,255,0.3);padding: 5px; padding-left: 10px;color:white}
      label {font-style: oblique;background-color: rgba(255, 255, 0,0.4);padding-left: 20px;padding-right: 20px;border-radius: 5px;}
      button{background-color:rgba(61, 148, 0 , 0.70);color:white;font-weight:bold;border-radius:5px;border-style: groove;border-color: rgba(61,178,0,0.5);padding-left: 10px;padding-right: 10px;height: 40px;cursor:pointer;}
      
    </style>
  </head>
  <body>
    <h1>Resize Photo</h1><p>
    <div id='file'>
      <input name='file' id='upload-file' type='file'class='hidden' accept='image/png,image/jpeg' onchange='return preview(event,0)'/><p>
      <button onclick='return clickFile()'>Choose a photo from your device</button><p>
      <img id='img'>
    </div>
    <div id='resize' class='hidden'>
      <canvas id="canvas" height='0px' ></canvas><br>
      <label id='label'class='hidden'></label><p>
      Resize <select id='resize-mode' onchange='return spanText(this)'><option value='percentage'>Percentage</option><option value='width'>Width</option><option value='height'>Height</option><option value='whatsapp'>Whatsapp DP</option></select> 
      <span id='span-pc'> to:<input type='number' id='percentage' style='width:50px' value='50'/></span>
      <span id='span-pc-suffix'>%</span>
      <button onclick='return doReduction()'>Resize</button>
      <button onclick='return reset()'>Choose another photo</button>
    </div>
    <div id='save' class='hidden'>
    <button onclick='return download()'>Download resized photo</button>
    </div>
  </body>
  
  <script>
    function clickFile(){
      getE('upload-file').click();
    }
    function preview(event){
      var url=URL.createObjectURL(event.target.files[0]);
      var outputImg = getE('img');  
      outputImg.src=url;
      getE('resize').setAttribute('class','visible');
    }
    
    function getE(ele){
      return document.getElementById(ele);
    }
    function spanText(e){
      switch(e.value){
        case 'percentage':getE('span-pc-suffix').innerHTML='%';getE('span-pc').setAttribute('class','visible');break;
        case 'width':getE('span-pc-suffix').innerHTML='px';getE('span-pc').setAttribute('class','visible');break;
        case 'height':getE('span-pc-suffix').innerHTML='px';getE('span-pc').setAttribute('class','visible');break;
        case 'whatsapp':getE('span-pc-suffix').innerHTML='';getE('span-pc').setAttribute('class','hidden');break;
      }
    }
    
    function doReduction(){
      var img=getE('img');
      var canvas=getE('canvas');
      const ctx = canvas.getContext("2d");
      var mode=getE('resize-mode').value;
      if (mode=='percentage'){ var pc=getE('percentage').value;}
      if (mode=='width'){ var pc=getE('percentage').value*100/img.width;}
      if (mode=='height'){ var pc=getE('percentage').value*100/img.height;}
      if(mode=='whatsapp'){
        if ((img.width<img.height)|(img.width==img.height)){var pc=500*100/img.width;}
        if (img.width>img.height){var pc=500*100/img.height;}
      }
      canvas.width=img.width*pc/100;
      canvas.height=img.height*pc/100;
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      getE('file').setAttribute('class','hidden');
      getE('save').setAttribute('class','visible');
      var txt='Resized (W X H) from '+img.width+'px X '+img.height+'px to '+canvas.width+'px X'+canvas.height+'px';
      getE('label').innerHTML=txt;
      getE('label').setAttribute('class','visible');
    }
    
    function download() {
     // get image URI from canvas object
     var canvas=getE('canvas');
     var imageURI = canvas.toDataURL("image/png",1.0).replace("image/png", "image/octet-stream");
     var a = document.createElement('a');
     a.href = imageURI;
     a.download = 'myImage.png';
     document.body.appendChild(a);
     a.click();
    }
    
    function reset(){
      getE('upload-file').value='';
      getE('canvas').setAttribute('height','0px');
      getE('img').setAttribute('src','');
      show('file');
    }
    function show(id){
      getE('file').setAttribute('class','hidden');
      getE('resize').setAttribute('class','hidden');
      getE('label').setAttribute('class','hidden');
      getE('save').setAttribute('class','hidden');
      getE(id).setAttribute('class','visible');
    }
  </script>
</html>


